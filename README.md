# MongoDB-Work Example

## Overview
This project explores **NoSQL database design and querying using MongoDB**, building on the Fakebook dataset used before. The goal is to understand how relational data can be transformed into a document-oriented format and how common analytical tasks differ between SQL and MongoDB.

The project consists of two independent parts:
- **Part A:** Export data from an Oracle relational database into a structured JSON file.
- **Part B:** Import the JSON data into MongoDB and write queries using MongoDB’s query and aggregation framework.

---

## Project Structure

### Part A: Oracle → JSON Export
Key files:
- **GetData.java** *(submitted)*  
  Queries the Oracle Fakebook database and constructs a JSON array of user documents.
- **Main.java**  
  Driver program that generates `output.json`.
- **sample.json**  
  Reference output generated by the instructor implementation.
- **Makefile**  
  Used to compile and run Part A.
- **json_simple / json libraries & ojdbc6.jar**  
  Supporting libraries for JSON handling and JDBC.

### Part B: MongoDB Queries
Key files:
- **query1.js – query7.js** *(submitted)*  
  JavaScript files containing MongoDB queries.
- **test.js**  
  Local test harness for partial correctness.
- **Makefile**  
  Used to load data into MongoDB and run tests.

---

## Dataset Design
Each user is represented as a **single MongoDB document**, containing:
- Basic user information (ID, name, gender, date of birth)
- A `friends` array (only friends with larger user IDs)
- Nested `current` and `hometown` objects for location data

This design emphasizes **denormalization** and enables efficient document-based querying.

---

## Part A: Export to JSON
In Part A, data is extracted from the Oracle Fakebook database and exported into a JSON array of 800 user documents.

Each user document includes:
- `user_id`, `first_name`, `last_name`, `gender`
- `YOB`, `MOB`, `DOB`
- `friends`: array of user IDs
- `current`: nested object (city, state, country)
- `hometown`: nested object (city, state, country)

If a user has no friends or location data, empty arrays or objects are used to ensure schema consistency.

---

## Part B: MongoDB Queries
Seven MongoDB queries are implemented to analyze the users collection:

1. **Townspeople** – Find users from a specific hometown city  
2. **Flatten Friends** – Convert nested friend lists into a flat friendship collection  
3. **City Dwellers** – Group users by current city  
4. **Matchmaker** – Identify potential matches based on gender, age, and hometown  
5. **Oldest Friends** – Find the oldest friend for each user  
6. **Average Friend Count** – Compute the average number of friends per user  
7. **Birth Months (Aggregation)** – Aggregate users by birth month using MongoDB’s pipeline  

Queries use a mix of:
- `find()`, `forEach()`
- Aggregation operators such as `$group`, `$unwind`, `$project`, and `$sum`

All queries are compatible with **MongoDB v3.6**, which is required by the autograder.

---

## Running the Project

### Part A
```bash
make compile
make run
